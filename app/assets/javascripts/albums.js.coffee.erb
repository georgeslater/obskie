
ready = ->

  $('img.albumArt').lazyload();

  $("input[name='sync_with_spotify']").click ->
    if $(this).val() == 'Manual' 
      $("#manualSection").show()
    else
      $("#manualSection").hide()
    return

  $("#mostList a").click (e) ->
    e.preventDefault()
    $(this).tab "show"

  $(".ratyTest").each (event, ui) ->
    that = this
    score = $(this).data('score')
    $(this).raty
      score: score
      starOn: '<%= image_path('star-on.png') %>'
      starOff: '<%= image_path('star-off.png') %>'
      path: ''
      scoreName: 'star'
      space: true
      readOnly: ->
        $(this).hasClass "author"

      click: (score, event) ->
        valText = score
        $(this).raty
          readOnly: true
          half: false
          score: score
          path: "/images"
          targetType: "score"
          halfShow: false
          targetKeep: true
          hints: [ valText, valText, valText, valText, valText ]
          $.ajax
            type: 'POST'
            url: '/ratings'
            data: score: score, track: $(this).data('trackid')
            success: (data, textStatus, jqXHR) ->
              $(that).attr('data-score', score) 
        false


$(document).ready(ready)

$("#menuContent").on "show.bs.collapse", ->
  $(".socialMediaLinks").hide()

$("#menuContent").on "shown.bs.collapse", ->
  $(".socialMediaLinks").show()

$("#menuContent").on "hide.bs.collapse", ->
  $(".socialMediaLinks").hide()

$("#menuContent").on "hidden.bs.collapse", ->
  $(".socialMediaLinks").show()

$(window).load ->
  $("#shareBtns").css "display", "block"
  return

((d, s, id) ->
  js = undefined
  fjs = d.getElementsByTagName(s)[0]
  return  if d.getElementById(id)
  js = d.createElement(s)
  js.id = id
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.0"
  fjs.parentNode.insertBefore js, fjs
  return
) document, "script", "facebook-jssdk"
